From 368d211a2b32334f844825220653fc2d2da1371d Mon Sep 17 00:00:00 2001
From: Siddharth Heroor <heroor@ti.com>
Date: Tue, 6 Sep 2011 08:24:46 +0530
Subject: [PATCH 10/10] ti816x: Add Decode/Display and Capture/Encode OMX IL Clients

* This is match the ti814x demos.

Signed-off-by: Siddharth Heroor <heroor@ti.com>
---
 trunk/ti816x/bin/runCaptureEncode      |   56 ++++++++++++++++++++++++++++++++
 trunk/ti816x/bin/runDecodeDisplayHDMI  |   56 ++++++++++++++++++++++++++++++++
 trunk/ti816x/html/menu_multimedia.html |   20 +++++++++++
 3 files changed, 132 insertions(+), 0 deletions(-)
 create mode 100755 trunk/ti816x/bin/runCaptureEncode
 create mode 100755 trunk/ti816x/bin/runDecodeDisplayHDMI

diff --git a/trunk/ti816x/bin/runCaptureEncode b/trunk/ti816x/bin/runCaptureEncode
new file mode 100755
index 0000000..40f8a5b
--- /dev/null
+++ b/trunk/ti816x/bin/runCaptureEncode
@@ -0,0 +1,56 @@
+#!/bin/sh
+
+
+
+#
+# Turn on the ALSA Mixer
+#
+configure_alsa_mixer()
+{
+   amixer sset 'Left PGA Mixer Mic3L' on
+   amixer sset 'Left PGA Mixer Mic3R' on
+   amixer sset 'Right PGA Mixer Mic3L' on
+   amixer sset 'Right PGA Mixer Mic3R' on
+
+   amixer cset name='PCM Playback Volume' 75%,75%
+   amixer cset name='PGA Capture Volume' 75%,75%
+}
+
+
+
+#
+# In order to view video, the graphics plane needs to be
+# disabled. Once the video has finished playing the graphics
+# plane needs to be re-enabled. 
+#
+# Call this function with 0 to disable graphics and 1 to
+# enable it.
+# 
+configure_graphics()
+{
+    echo $1 > /sys/devices/platform/vpss/graphics0/enabled
+    echo $1 > /sys/devices/platform/vpss/graphics1/enabled
+}
+
+
+
+
+# 
+# Call this function to setup and execute the demo 
+# 
+execute_demo()
+{
+    cd /usr/share/ti/ti-omx
+
+    ./capture_encode_a8host_debug.xv5T -o sample.h264 -m 1080p -f 60 -b 1000000 -n 1000 -d 1
+}
+
+
+# Disable Graphics Plane so that Video can be seen.
+configure_graphics 0
+
+configure_alsa_mixer
+execute_demo
+    
+# Enable Graphics again.
+configure_graphics 1
diff --git a/trunk/ti816x/bin/runDecodeDisplayHDMI b/trunk/ti816x/bin/runDecodeDisplayHDMI
new file mode 100755
index 0000000..1a60f59
--- /dev/null
+++ b/trunk/ti816x/bin/runDecodeDisplayHDMI
@@ -0,0 +1,56 @@
+#!/bin/sh
+
+
+
+#
+# Turn on the ALSA Mixer
+#
+configure_alsa_mixer()
+{
+   amixer sset 'Left PGA Mixer Mic3L' on
+   amixer sset 'Left PGA Mixer Mic3R' on
+   amixer sset 'Right PGA Mixer Mic3L' on
+   amixer sset 'Right PGA Mixer Mic3R' on
+
+   amixer cset name='PCM Playback Volume' 75%,75%
+   amixer cset name='PGA Capture Volume' 75%,75%
+}
+
+
+
+#
+# In order to view video, the graphics plane needs to be
+# disabled. Once the video has finished playing the graphics
+# plane needs to be re-enabled. 
+#
+# Call this function with 0 to disable graphics and 1 to
+# enable it.
+# 
+configure_graphics()
+{
+    echo $1 > /sys/devices/platform/vpss/graphics0/enabled
+    echo $1 > /sys/devices/platform/vpss/graphics1/enabled
+}
+
+
+
+
+# 
+# Call this function to setup and execute the demo 
+# 
+execute_demo()
+{
+    cd /usr/share/ti/ti-omx
+
+    ./decode_display_a8host_debug.xv5T -w 1920 -h 1080 -f 60 -i /usr/share/ti/data/videos/dm816x_1080p_demo.264 -g 0 -d 0
+}
+
+
+# Disable Graphics Plane so that Video can be seen.
+configure_graphics 0
+
+configure_alsa_mixer
+execute_demo
+    
+# Enable Graphics again.
+configure_graphics 1
diff --git a/trunk/ti816x/html/menu_multimedia.html b/trunk/ti816x/html/menu_multimedia.html
index 8c83dfc..f07c8db 100755
--- a/trunk/ti816x/html/menu_multimedia.html
+++ b/trunk/ti816x/html/menu_multimedia.html
@@ -74,5 +74,25 @@
     </object>
     <div class="desc">1080p60 Encode+Decode (requires Daughter card)</div>
   </div>
+  <div class="object">
+    <object type="application/x-matrix" >
+      <param name="iconName" value="/usr/share/matrix/images/video-conference-icon.png" />
+      <param name="appName" value="runDecodeDisplayHDMI" />
+      <param name="appText" value="Disable" />
+      <param name="appDesc" value="/usr/share/matrix/html/desc_1080p_decode_display.html" />
+      <param name="terminateMatrix" value="Disable" />
+    </object>
+    <div class="desc">1080p60 Decode and Display on HDMI</div>
+  </div>
+  <div class="object">
+    <object type="application/x-matrix" >
+      <param name="iconName" value="/usr/share/matrix/images/video-conference-icon.png" />
+      <param name="appName" value="runCaptureEncode" />
+      <param name="appText" value="Disable" />
+      <param name="appDesc" value="/usr/share/matrix/html/desc_1080p_capture_encode.html" />
+      <param name="terminateMatrix" value="Disable" />
+    </object>
+    <div class="desc">1080p60 Capture and Encode (requires Daughter card)</div>
+  </div>
 </body>
 </html>
-- 
1.7.0.4

